---
import type { MenuItem } from "../lib/wp-menu";
import { getFseMenu } from "../lib/wp-menu";

const menuItems: MenuItem[] = await getFseMenu("navigation");

// Client-Side Toggle fÃ¼r Mobile Nav:
const mobileToggleScript = `
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.querySelector('[data-mobile-toggle]');
    const nav = document.querySelector('[data-mobile-nav]');
    btn?.addEventListener('click', () => {
      nav?.classList.toggle('hidden');
    });
  });
`;
---

<head>
  <script is:inline>
    {
      mobileToggleScript;
    }
  </script>
</head>

<header class="w-full border-b border-gray-200 bg-white">
  <div
    class="mx-auto flex max-w-7xl items-center justify-between px-4 py-4 md:px-6"
  >
    <!-- Logo -->
    <a href="/" class="text-xl font-semibold tracking-tight">Astro Demo</a>

    <!-- Mobile Toggle Button -->
    <button
      data-mobile-toggle
      class="block rounded-md border border-gray-300 px-3 py-2 text-sm md:hidden"
    >
      Menu
    </button>

    <!-- Navigation -->
    <nav
      data-mobile-nav
      class="hidden w-full flex-col gap-4 pt-4 md:flex md:w-auto md:flex-row md:items-center md:gap-6 md:pt-0"
    >
      <ul class="flex flex-col gap-4 md:flex-row md:gap-6">
        {
          menuItems.map((item) => (
            <li class="group relative">
              <a
                href={item.url}
                class="block py-2 text-gray-700 hover:text-black"
              >
                {item.label}
              </a>

              {item.children.length > 0 && (
                <ul class="absolute top-full left-0 hidden w-48 rounded-md border border-gray-200 bg-white shadow-md group-hover:block md:group-hover:block">
                  {item.children.map((child) => (
                    <li>
                      <a
                        href={child.url}
                        class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"
                      >
                        {child.label}
                      </a>
                    </li>
                  ))}
                </ul>
              )}
            </li>
          ))
        }
      </ul>
    </nav>
  </div>
</header>
